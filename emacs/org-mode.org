#+title: Org-mode

* Org

#+begin_src emacs-lisp
  (defvar org-directory "~/org")
  (use-package org
    :config
    (org-indent-mode 1)
    (add-to-list 'org-babel-default-header-args
                 '(:mkdirp . "yes"))
    (org-babel-do-load-languages 'org-babel-load-languages
                                 '((emacs-lisp . t)
                                   (shell      . t)))
    (defun actuator-update-all-dynamic-blocks ()
      "Hi"
      (org-dblock-update 1))
    (add-hook 'org-mode-hook
              (lambda ()
                (add-hook 'before-save-hook
                          'actuator-update-all-dynamic-blocks nil
                          'make-it-local)))
    (add-to-list 'org-default-properties "DIR")
    (add-to-list 'org-default-properties "header-args")
    :bind
    ("C-c c" . counsel-org-capture)
    ("C-c a" . org-agenda)
    ("C-c l" . org-store-link)
    :custom
    (org-display-custom-times t)
    (org-time-stamp-custom-formats
     '("<%A, %B %e %Y>" . "<%A, %B %e %Y %H:%M>"))
    (org-startup-folded 'content)
    (org-ellipsis "â†’")
    (org-startup-align-all-tables t)
    (org-startup-shrink-all-tables t)
    (org-startup-with-inline-images t)
    (org-startup-indented t)
    (org-hide-leading-stars t)
    (org-pretty-entities-include-sub-superscripts t)
    (org-hide-emphasis-markers t)
    (org-image-actual-width 300)
    (org-fontify-done-headline t)
    (org-structure-template-alist '(("e" . "src emacs-lisp")
                                    ("s" . "src shell")))
    (org-log-done 'time)
    (org-log-into-drawer t)
    (org-closed-keep-when-no-todo t)
    (org-enforce-todo-dependencies t)
    (org-enforce-todo-checkbox-dependencies t)
    (org-complete-tags-always-offer-all-agenda-tags nil)
    (org-clone-delete-id t)
    (org-tags-column -60)
    (org-catch-invisible-edits 'show-and-error)
    (org-insert-heading-respect-content t)
    (org-ctrl-k-protect-subtree t)
    (org-M-RET-may-split-line '((default . nil)))
    (org-special-ctrl-k t)
    (org-special-ctrl-a/e t)
    (org-blank-before-new-entry '((heading         . t)
                                  (plain-list-item . auto)))
    (org-use-property-inheritance t)
    (org-modules nil)
    (org-tag-persistent-alist '(("noexport")
                                ("ignore")
                                ("unpublished")
                                ("blog")
                                ("tbd")))
    :hook
    (org-mode . visual-line-mode))
#+end_src

#+results:
: org-store-link

#+begin_src emacs-lisp
  (setq org-agenda-files `(,org-directory
                           ,(if (getenv "XDG_CONFIG_HOME")
                                (getenv "XDG_CONFIG_HOME")
                              "~/.config")
                           ,user-emacs-directory))
#+end_src


#+begin_src emacs-lisp
  (use-package org-capture
    :config
    (defun actuator-org-capture-turn-off-header-line ()
    "Disable the header-line in a local mode.
  This is used to disable the help line in `org-capture' buffers as
  there's no variable that will do it."
    (setq-local header-line-format nil))
    :hook (org-capture-mode . actuator-org-capture-turn-off-header-line))
#+end_src

#+begin_src emacs-lisp
  (use-package org-list
    :custom
    (org-list-indent-offset 1))
#+end_src

#+begin_src emacs-lisp
  (use-package org-keys
    :custom
    (org-use-speed-commands t))
#+end_src

#+begin_src emacs-lisp
  (use-package org-refile
    :custom
    (org-refile-allow-creating-parent-nodes 'confirm)
    (org-outline-path-complete-in-steps nil)
    (org-refile-use-outline-path 'file)
    (org-refile-targets '((org-agenda-files :maxlevel . 3)))
    :hook
    (midnight-mode . org-refile-get-targets))
#+end_src

#+begin_src emacs-lisp
  (use-package org-src
    :config
    (defun actuator-org-src-line-wrap-setup ()
      "Set truncate-lines-mode in org-source-editing buffers."
      (setq-local truncate-lines t))
    :custom
    (org-edit-src-persistent-message nil)
    (org-src-tab-acts-natively t)
    (org-src-window-setup 'current-window)
    (org-src-ask-before-returning-to-edit-buffer nil)
    (org-src-fontify-natively t)
    :hook (org-src-mode . actuator-org-src-line-wrap-setup))
#+end_src

#+begin_src emacs-lisp
  (use-package org-footnote
    :custom
    (org-footnote-auto-adjust t)
    (org-footnote-define-inline t)
    (org-footnote-auto-label 'random))
#+end_src

#+begin_src emacs-lisp
  (use-package ob-core
    :custom
    (org-confirm-babel-evaluate nil)
    (org-babel-results-keyword "results"))
#+end_src

#+begin_src emacs-lisp
  (use-package org-crypt
    :init
    (require 'org-crypt)
    :config
    (org-crypt-use-before-save-magic)
    (add-to-list 'org-modules 'org-crypt)
    :custom
    (org-tags-exclude-from-inheritance (quote ("crypt")))
    (org-crypt-key nil))
#+end_src

#+begin_src emacs-lisp
  (use-package org-agenda
    :straight nil
    :custom
    (org-agenda-sticky t)
    (org-agenda-dim-blocked-tasks t))
#+end_src

#+begin_src emacs-lisp
  (use-package org-id
    :straight nil
    :custom
    (org-id-link-to-org-use-id nil)
    :hook (midnight-mode . org-id-update-id-locations))
#+end_src

#+results:
| org-id-update-id-locations | org-refile-get-targets | recentf-cleanup |

* Cliplink
:PROPERTIES:
:ID:       B592B761-0FC7-4954-927A-189783720DD2
:END:
#+begin_src emacs-lisp
  (use-package org-cliplink
    :straight t
    :bind ("C-x p i" . org-cliplink)
    :init
    (with-eval-after-load 'org-capture
      (add-to-list 'org-capture-templates
                  `("b" "Bookmark" entry (file+olp+datetree ,(expand-file-name "bookmarks.org" org-directory))
                     "* %(org-cliplink-capture) %^g "
                     :immediate-finish
                     :kill-buffer))))
#+end_src

#+results:
: org-cliplink

* Attach
:PROPERTIES:
:ID:       7542A761-77AB-4B42-B25E-33BFE7A45FE9
:END:

#+begin_src emacs-lisp
  (use-package org-attach
    :straight nil
    :custom
    (org-attach-store-link-p t)
    (org-attach-expert nil)
    (org-attach-dir-relative t)
    (org-attach-preferred-new-method 'dir)
    (org-attach-method 'mv)
    (org-attach-auto-tag "attach")
    (org-attach-archive-delete 'query))
#+end_src

#+results:

#+begin_src emacs-lisp
  (use-package org-download
    :straight t
    :bind ("C-M-y" . org-download-screenshot)
    :config
    (require 'org-download)
    :custom
    (org-download-method 'attach)
    ;;(org-download-annotate-function #'actuator-org-dl-annotate)
    ;;(org-download-timestamp "")
    ;;(org-download-screenshot-method "screencapture -i %s")
    (org-download-heading-lvl nil)
    (org-download-timestamp "%Y%m%d-%H%M%S-")
    (org-download-screenshot-method "/usr/local/bin/pngpaste %s")
    )
#+end_src

* Clock

#+begin_src emacs-lisp
  (use-package org-clock
    :straight nil
    :init
    (org-clock-persistence-insinuate)
    :custom
    (org-clock-persist t)
    (org-clock-out-remove-zero-time-clocks t)
    (org-clock-mode-line-total 'auto))
#+end_src

#+begin_src emacs-lisp
  (use-package org-mru-clock
    :disabled t
    :straight t
    :bind
    ("C-c C-x i" . org-mru-clock-in)
    ("C-c C-x C-j . org-mru-clock-select-recent-task")
    :custom
    (org-mru-clock-completing-read 'ivy-completing-read))
#+end_src

* Capture Templates
:PROPERTIES:
:ID:       105E87F2-7E4C-44A1-94BE-1DD64B9F01A2
:END:
#+begin_src emacs-lisp
  (use-package org-capture
    :straight nil)
#+end_src

#+begin_src emacs-lisp
  (with-eval-after-load 'org-capture
    (add-to-list 'org-capture-templates
                 `("r" "Run" entry
                   (file+olp+datetree ,(expand-file-name "run-log.org" org-directory))
                   "* %<%A %e %B %Y (W%V)> %^{Duration}p %^{Distance}p
                 %^{Elevation}p %^{Pace}p \n%?"
                   :time-prompt
                   :kill-buffer)))
#+end_src

#+begin_src emacs-lisp
  (with-eval-after-load 'org-capture
    (add-to-list 'org-capture-templates
                 `("w" "Watched Film" entry
                   (file+olp+datetree ,(expand-file-name "watch-log.org" org-directory))
                   "* %^{Title} (%^{Year}) %^{Series}p
               %^{SeriesNo}p %^{Rating|2|1|3}p"
                   :time-prompt
                   :kill-buffer)))
#+end_src

#+begin_src emacs-lisp
  (with-eval-after-load 'org-capture
    (add-to-list 'org-capture-templates
                 `("i" "Inbox" entry
                   (file ,(expand-file-name "inbox.org" org-directory))
                   "* %^{Title} \n %u \n %i \n\n %a")))
#+end_src

#+begin_src emacs-lisp
  (with-eval-after-load 'org-capture
    (add-to-list 'org-capture-templates
                 `("f" "Finished Book" entry
                   (file+olp+datetree ,(expand-file-name "reading-log.org" org-directory))
                   "* %^{Author Name} - %^{Title} (%^{Year}) %^{Series}p
                 %^{SeriesNo}p %^{Author}p %^{Rating|2|1|3}p"
                   :time-prompt
                   :kill-buffer)))
#+end_src

* Todos
#+begin_src emacs-lisp
  (use-package org-agenda
    :straight nil
    :custom
    (org-agenda-todo-list-sublevels nil))
#+end_src

* Links
#+begin_src emacs-lisp
  (use-package ol
    :straight nil
    :custom
    (org-link-frame-setup '((vm . vm-visit-folder-other-frame)
                            (vm-imap . vm-visit-imap-folder-other-frame)
                            (gnus . org-gnus-no-new-news)
                            (file . find-file))))
#+end_src

* Agenda

#+begin_src emacs-lisp
  (setq org-agenda-custom-commands
        '(("X" agenda ""
           ((ps-number-of-columns 2)
            (ps-landscape-mode t)
            (org-agenda-prefix-format " [ ] ")
            (org-agenda-with-colors nil)
            (org-agenda-start-day "Mon")
            (org-agenda-remove-tags t))
           ("~/Desktop/theagenda.pdf"))))
  (setq org-agenda-window-setup 'only-window)
  (setq org-agenda-restore-windows-after-quit t)
  (setq org-agenda-span 'fortnight)
  (setq org-agenda-include-diary t)
  (setq org-agenda-text-search-extra-files nil)
#+end_src

#+results:

* Holidays
:PROPERTIES:
:CATEGORY: Holiday
:END:
#+begin_src emacs-lisp
  (setq holiday-islamic-holidays nil)
  ;;(setq holiday-christian-holiday nil)
  (setq holiday-bahai-holidays nil)
  (setq holiday-oriental-holidays nil)
  ;;(setq holiday-other-holidays '((lunar-phases)))
#+end_src
* Habit

#+begin_src emacs-lisp
  (use-package org-habit
    :straight nil
    :config
    (add-to-list 'org-modules 'org-habit)
    :custom
    (org-habit-show-habits-only-for-today nil))
#+end_src

* Checklist

#+begin_src emacs-lisp
  (use-package org-checklist
    :straight nil
    :config
    (add-to-list 'org-modules 'org-checklist))
#+end_src

#+results:
: t
